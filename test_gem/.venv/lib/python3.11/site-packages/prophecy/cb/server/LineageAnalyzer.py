import json

from prophecy.cb.util.Utils import createScalaList


def analyzeLineage(id, name, component, in_ports, out_ports, in_dfs, out_dfs, spark):
    jvm = spark.sparkContext._jvm
    lineageWriter = jvm.io.prophecy.libs.lineage.LineageWriter()
    jin_ports = createScalaList(in_ports, spark)
    jout_ports = createScalaList(out_ports, spark)
    jin_dfs = createScalaList([x._jdf for x in in_dfs], spark)
    jout_dfs = createScalaList([x._jdf for x in out_dfs], spark)
    lProcess = json.loads(
        lineageWriter.writeLineageJson(id, name, component, jin_dfs, jout_dfs, jin_ports, jout_ports))
    return lProcess